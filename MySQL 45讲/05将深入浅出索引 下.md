## 深入浅出索引 下
## 覆盖索引
> 二级索引中的内容已经满足了我们需要查出来的数据,则不需要在执行回表操作
> 覆盖索引可以减少树的搜索次数,显著提升查询性能

## 最左前缀原则
- 可以利用最左前缀来定位记录
- 简单说联合索引(a,b,c)其实覆盖了(a)和(a,b)和(a,b,c)三个索引
- 我们只需要维护一个索引实际上就创建了三个索引,可以提高性能减少存储空间
- 安排联合索引的字段顺序的方式:
	- 评估索引的**复用能力**
	- 如果可以通过调整顺序减少维护索引数量,那就优先采用此操作

## 索引下推
- 在MySQL5.6开始引入
- 当某个查询条件命中了索引后,InnoDB会根据查询条件匹配最优的二级联合索引
- 验证其他索引项可不可以减少回表次数
- 可以参考下面的逻辑,这就是索引下推的用途
`select * from tuser where name like '张%' and age=10 and ismale=1;`
![](http://img.jaken.top/image/20211127214329.png)

## 索引释放
- InnoDB中删除了表的部分记录,索引是不会释放的
- 只有重新建表才可以重建索引
- 这个其实就是后面InnoDB删除的逻辑(为什么要用逻辑删除)

## Multi-Range Read多范围读
- 减少随机IO,吧随机IO转换为顺序IO
- 由于使用二级索引查询出来的主键索引可能是乱序的
- 在MySQL 5.6之前,他会根据查询的结果直接访问主键树(随机IO页命中率低)
- 在MySQL 5.6及以后,他会将查询结果按照ID排序,转换为顺序IO
- 通过`potimizer_switch`标记是否使用MRR
- 当设置`mrr=on`时，表示启用MRR优化。
- `mrr_cost_based`表示是否通过`cost base`基于成本的方式来启用MRR
	- 如果开启,则会判断此次优化是否代价过高,过高则不优化
- 默认都为启动状态